<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Cllipora AI</title>

<!-- Link Preview Metadata -->
<meta property="og:title" content="Cllipora AI" />
<meta property="og:description" content="Chat with Black Hat AI — Fast, sleek, and private AI assistant." />
<meta property="og:image" content="https://i.ibb.co/zWjn5ykZ/512.png" />
<meta property="og:url" content="https://cllipora.netlify.app" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Cllipora AI" />
<meta name="twitter:description" content="Chat with Black Hat AI — Fast, sleek, and private AI assistant." />
<meta name="twitter:image" content="https://i.ibb.co/zWjn5ykZ/512.png" />

<link rel="icon" href="https://i.ibb.co/zWjn5ykZ/512.png" type="image/png">
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
<style>
  :root {
    --bg: #0b0f14;
    --panel: #0f1520;
    --text: #e5e7eb;
    --muted: #9ca3af;
    --accent: #7c3aed;
    --accent2: #22d3ee;
  }
  * { scrollbar-width: thin; scrollbar-color: var(--accent) var(--panel); }
  *::-webkit-scrollbar { width: 8px; height: 8px; }
  *::-webkit-scrollbar-track { background: var(--panel); }
  *::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 4px; }
  *::-webkit-scrollbar-thumb:hover { background: var(--accent2); }
  @keyframes spin { to { transform: rotate(360deg); } }
  .spinner { border-top-color: var(--accent); animation: spin 1s linear infinite; }
  .message-text { white-space: pre-wrap; word-wrap: break-word; line-height: 1.45; }
  .msg-bubble { max-width: 680px; border: 1px solid #1f2937; border-radius: 0.75rem; padding: 0.75rem; background-image: linear-gradient(to bottom, #0f1520, #0c1320); }
  .msg-bubble.user { background-image: linear-gradient(to bottom right, #7c3aed, #a78bfa); color: white; border-top-right-radius: 0; }
  .msg-bubble.ai { color: #e5e7eb; border-top-left-radius: 0; }
  .msg-header { font-size: 0.75rem; color: var(--muted); margin-bottom: 0.25rem; display: flex; align-items: baseline; gap: 0.5rem; }
  #searchHistory { background-color: #0a1220; border: 1px solid #1f2937; padding: 0.4rem 0.5rem; border-radius: 0.5rem; width: 100%; color: white; }
  #searchHistory:focus { outline: none; border-color: var(--accent); }
  body { height: 100vh; display: flex; overflow: hidden; }
  aside { flex-shrink: 0; width: 16rem; background: var(--panel); border-right: 1px solid #1f2937; display: flex; flex-direction: column; }
  header { flex-shrink: 0; background: var(--bg); border-bottom: 1px solid #1f2937; z-index: 20; }
  footer { flex-shrink: 0; background: var(--bg); border-top: 1px solid #1f2937; }
  #chatWrapper { flex: 1; overflow-y: auto; padding: 1rem; position: relative; }
  #input { max-height: calc(1.5em * 9); overflow-y: auto; }
  #gradientPlaceholder { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: clamp(1.5rem, 5vw, 2.5rem); font-weight: 600; background: linear-gradient(to right, var(--accent), var(--accent2)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-align: center; pointer-events: none; transition: transform 0.5s ease, opacity 0.5s ease; font-family: 'Segoe UI', sans-serif; white-space: nowrap; }
  #gradientPlaceholder.slide-up { transform: translate(-50%, -80%) scale(0.85); opacity: 0; }
  @media (max-width: 768px) {
    aside { position: fixed; left: -100%; top: 0; bottom: 0; z-index: 50; transition: left 0.3s ease; }
    aside.open { left: 0; }
    #gradientPlaceholder { font-size: clamp(1.2rem, 6vw, 2rem); }
  }
</style>
</head>
<body class="bg-[#0b0f14] text-gray-200">

<!-- Splash Screen -->
<div id="splashScreen" style="
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100vh;
  background: linear-gradient(#000000);
  z-index: 99999;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  transition: opacity 0.5s ease;
">
  <!-- Logo -->
  <img src="https://i.ibb.co/zWjn5ykZ/512.png"
       alt="Black Hat AI Logo"
       style="width: 100px; height: 100px;" />

  <!-- Two-line text -->
  <div style="
    position: absolute;
    bottom: 40px;
    text-align: center;
    font-family: 'Helvetica Neue', sans-serif;
    font-size: 1rem;
    font-weight: 600;
    line-height: 1.4;
  ">
    <div style="color: #e5e7eb;">from</div>
    <div style="
      background: linear-gradient(90deg, #6366f1, #FF7D1E, #ec4899);
      background-clip: text;
      -webkit-background-clip: text;
      color: transparent;
      -webkit-text-fill-color: transparent;
    ">
      INDUWARA JAYASINGHE
    </div>
  </div>
</div>

<aside id="sidebar">
  <div class="flex items-center gap-3 p-4 border-b border-gray-800">
    <img src="https://i.ibb.co/zWjn5ykZ/512.png" alt="Logo" class="w-8 h-8 rounded">
    <span class="font-bold text-lg">Black Hat AI</span>
    <button id="closeSidebar" class="ml-auto md:hidden text-gray-400 hover:text-white"><i class="fas fa-times"></i></button>
  </div>
  <div class="p-3 border-b border-gray-800">
    <input type="text" id="searchHistory" placeholder="Search chats..." />
  </div>
  <div id="historyList" class="flex-1 overflow-y-auto p-2 space-y-2 text-sm"></div>
  <div class="p-3 border-t border-gray-800 hidden md:block">
    <button id="clearHistoryDesktop" class="w-full bg-red-600 rounded-lg py-2 hover:bg-red-700 transition">Clear History</button>
  </div>
</aside>

<div class="flex flex-col flex-1 min-w-0">
  <header class="p-4 flex items-center justify-between">
    <div class="flex items-center gap-3">
      <button id="openSidebar" class="md:hidden text-gray-400 hover:text-white"><i class="fas fa-bars"></i></button>
      <span class="font-bold text-lg">Black Hat AI</span>
    </div>
    <div class="flex gap-2">
      <select id="model" class="bg-[#0f1520] border border-gray-700 rounded px-2 py-1 text-sm">
        <option value="gemini-1.5-flash">Fast</option>
        <option value="gemini-1.5-pro">Pro</option>
      </select>
      <button id="newChat" class="px-3 py-1 bg-gray-800 rounded-lg hover:bg-gray-700 transition text-sm">New</button>
    </div>
  </header>

  <div id="chatWrapper">
    <div id="gradientPlaceholder">How can I help you today?</div>
  </div>

  <footer class="p-3 flex gap-2">
    <textarea id="input" rows="1" placeholder="Ask anything…" class="flex-1 bg-[#0a1220] border border-gray-800 p-2 rounded-lg resize-none text-sm focus:outline-none focus:ring-2 focus:ring-[#7c3aed]"></textarea>
    <button id="send" class="px-4 py-2 bg-gradient-to-tr from-[#7c3aed] to-[#22d3ee] rounded-lg font-bold hover:from-[#6b21a8] hover:to-[#0ea5e9] transition text-sm">Send</button>
  </footer>
</div>

<script>
document.getElementById('openSidebar').onclick = () => document.getElementById('sidebar').classList.add('open');
document.getElementById('closeSidebar').onclick = () => document.getElementById('sidebar').classList.remove('open');

let historyData = [];
let currentSessionId = null;
let sessions = JSON.parse(localStorage.getItem('bhai_sessions') || '{}');

function renderHistory(filterText = '') {
  const list = document.getElementById('historyList');
  list.innerHTML = '';
  Object.entries(sessions)
    .sort((a,b) => b[1].ts - a[1].ts)
    .forEach(([id, sess]) => {
      const firstMsg = sess.messages.find(m=>m.role==='user');
      const title = firstMsg ? firstMsg.text.slice(0,60) : 'New Chat';
      const when = new Date(sess.ts).toLocaleString();
      if (filterText && !(title.toLowerCase().includes(filterText) || when.toLowerCase().includes(filterText))) return;
      const container = document.createElement('div');
      container.className = 'flex justify-between items-center w-full rounded hover:bg-gray-700';
      const btn = document.createElement('button');
      btn.className = 'flex-1 text-left p-2 text-sm truncate';
      btn.textContent = title;
      btn.onclick = () => { 
        loadSession(id); 
        history.pushState({}, '', `?session=${id}`); // URL change here
        if(window.innerWidth < 768) document.getElementById('sidebar').classList.remove('open'); 
      };
      const delBtn = document.createElement('button');
      delBtn.className = 'text-red-500 hover:text-red-700 px-2 py-1';
      delBtn.innerHTML = '<i class="fas fa-trash-alt"></i>';
      delBtn.onclick = (e) => {
        e.stopPropagation();
        if(confirm('Delete this chat?')) {
          delete sessions[id];
          localStorage.setItem('bhai_sessions', JSON.stringify(sessions));
          if(currentSessionId === id) { currentSessionId = null; historyData = []; document.getElementById('chatWrapper').innerHTML = '<div id="gradientPlaceholder">How can I help you today?</div>'; }
          renderHistory(filterText);
        }
      };
      container.appendChild(btn);
      container.appendChild(delBtn);
      list.appendChild(container);
    });
}
document.getElementById('searchHistory').addEventListener('input', e => renderHistory(e.target.value.trim().toLowerCase()));

function saveCurrentSession() {
  if (!currentSessionId) return;
  sessions[currentSessionId] = { ts: Date.now(), messages: historyData };
  localStorage.setItem('bhai_sessions', JSON.stringify(sessions));
  renderHistory();
}

function loadSession(id) {
  currentSessionId = id;
  historyData = sessions[id].messages;
  document.getElementById('chatWrapper').innerHTML = '';
  historyData.forEach(m => addMessage(m.role, m.text, m.ts, false));
}

function startNewSession() {
  if (historyData.length > 0) saveCurrentSession();
  currentSessionId = Date.now().toString();
  historyData = [];
  document.getElementById('chatWrapper').innerHTML = '<div id="gradientPlaceholder">How can I help you today?</div>';
  history.pushState({}, '', `/new`);
}

function formatTime(ts){ return new Date(ts).toLocaleTimeString(); }

function addMessage(role, text, ts = Date.now(), save = true) {
  if (save) historyData.push({ role, text, ts });
  const row = document.createElement('div');
  row.className = 'flex gap-3 my-2 items-start max-w-full ' + (role === 'user' ? 'justify-end' : 'justify-start');
  const avatar = document.createElement('div');
  avatar.className = 'w-9 h-9 rounded-lg border border-gray-800 overflow-hidden grid place-items-center';
  if (role === 'user') {
    avatar.classList.add('bg-gradient-to-br','from-purple-700','to-purple-400','text-white','order-2');
    avatar.textContent = 'U';
  } else {
    avatar.classList.add('order-1','bg-black');
    avatar.innerHTML = `<img src="https://i.ibb.co/zWjn5ykZ/512.png" class="w-full h-full object-cover">`;
  }
  const bubble = document.createElement('div');
  bubble.className = 'msg-bubble ' + (role === 'user' ? 'user order-1' : 'ai order-2');
  const header = document.createElement('div');
  header.className = 'msg-header';
  header.innerHTML = `<span>${role === 'user' ? 'You' : 'Black Hat AI'}</span> • <span>${formatTime(ts)}</span>`;
  const body = document.createElement('div');
  body.className = 'message-text';
  body.textContent = text;
  bubble.append(header, body);
  row.append(role === 'user' ? bubble : avatar, role === 'user' ? avatar : bubble);
  const board = document.getElementById('chatWrapper');
  board.appendChild(row);
  board.scrollTop = board.scrollHeight;
}

function addTyping() {
  const row = document.createElement('div');
  row.className = 'flex gap-3 my-2 items-start justify-start max-w-full';
  const avatar = document.createElement('div');
  avatar.className = 'w-9 h-9 rounded-lg border border-gray-800 overflow-hidden order-1';
  avatar.innerHTML = `<img src="https://i.ibb.co/zWjn5ykZ/512.png" class="w-full h-full object-cover">`;
  const bubble = document.createElement('div');
  bubble.className = 'msg-bubble ai order-2';
  const header = document.createElement('div');
  header.className = 'msg-header';
  header.innerHTML = `<span>Black Hat AI</span> • <span>${formatTime(Date.now())}</span>`;
  const typingLine = document.createElement('div');
  typingLine.className = 'flex items-center text-sm';
  const spinner = document.createElement('span');
  spinner.className = 'spinner inline-block w-3.5 h-3.5 rounded-full border-2 border-gray-700 mr-2';
  typingLine.append(spinner, document.createTextNode('Thinking…'));
  bubble.append(header, typingLine);
  row.append(avatar, bubble);
  document.getElementById('chatWrapper').appendChild(row);
  return { bubble };
}

async function generateWithAPI(userText) {
  const model = document.getElementById('model').value;
  const url = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=AIzaSyAd0wLes7N-wifp5N54NEDsUb7Kz_uss8c`;
  const payload = { contents: [{ role: "user", parts: [{ text: userText }] }], generationConfig: { temperature: 0.7, topP: 0.95, maxOutputTokens: 8192 } };
  const res = await fetch(url, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
  if (!res.ok) throw new Error(await res.text());
  const data = await res.json();
  return data?.candidates?.[0]?.content?.parts?.map(p=>p.text).join('\n') || 'No response.';
}

async function handleSend() {
  const input = document.getElementById('input');
  const text = input.value.trim();
  if (!text) return;

  const placeholder = document.getElementById('gradientPlaceholder');
  if (placeholder) {
    placeholder.classList.add('slide-up');
    setTimeout(() => placeholder.remove(), 500);
  }

  addMessage('user', text);
  input.value = '';
  input.style.height = 'auto';
  const typing = addTyping();
  try {
    const reply = await generateWithAPI(text);
    typing.bubble.innerHTML = `<div class="msg-header"><span>Black Hat AI</span> • <span>${formatTime(Date.now())}</span></div><div class="message-text">${reply}</div>`;
    historyData.push({ role: 'model', text: reply, ts: Date.now() });
    saveCurrentSession();
  } catch (err) {
    typing.bubble.innerHTML = `<span class="text-red-400">Error:</span> ${err.message}`;
  }
}

document.getElementById('send').onclick = handleSend;
document.getElementById('newChat').onclick = startNewSession;
document.getElementById('clearHistoryDesktop').onclick = () => { sessions={}; localStorage.removeItem('bhai_sessions'); renderHistory(); startNewSession(); };
document.getElementById('input').addEventListener('keydown', e=>{ if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); handleSend(); }});
document.getElementById('input').addEventListener('input', e => {
  e.target.style.height = 'auto';
  const maxHeight = parseFloat(getComputedStyle(e.target).lineHeight) * 9;
  e.target.style.height = Math.min(e.target.scrollHeight, maxHeight) + 'px';
});

renderHistory();
startNewSession();





</script>


<script>
// Splash screen timeout
window.addEventListener('load', () => {
  setTimeout(() => {
    const splash = document.getElementById('splashScreen');
    splash.style.opacity = '0';
    setTimeout(() => splash.remove(), 500);
  }, 3000);
});
</script>


</body>
</html>


